#!/bin/env sh

country=${1:-germany}
data="$(curl -s "https://corona.lmao.ninja/countries/${country}")"

[ -z data ] && exit 1

JQ_COMMAND="\
def h: tostring | [while(length>0; .[:-3]) | .[-3:]] | reverse | join(\".\"); \
@text \"\
ðŸ˜· \\(.cases | h)\
 (+\\(.todayCases | h))\
 ðŸ˜¨ \\(.active | h)\
 ðŸ˜± \\(.critical | h)\
 ðŸ’€ \\(.deaths | h)\
 (+\\(.todayDeaths | h))\
 ðŸ˜‡ \\(.recovered | h)\
\"\
"

echo "$data" | jq -r "$JQ_COMMAND" 2> /dev/null
